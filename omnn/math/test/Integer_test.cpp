//
// Created by Сергей Кривонос on 02.09.17.
//
#define BOOST_TEST_MODULE Integer test
#include <boost/test/unit_test.hpp>

#include "Integer.h"
#include "Fraction.h"

#include <iostream>
#include <chrono>

#include <boost/math/special_functions/prime.hpp>
#include <rt/Prime.h>

using int_t = omnn::math::Integer;


template<typename TimeT = std::chrono::milliseconds>
struct measure
{
    template<typename F, typename ...Args>
    static typename TimeT::rep execution(F&& func, Args&&... args)
    {
        auto start = std::chrono::steady_clock::now();
        std::forward<decltype(func)>(func)(std::forward<Args>(args)...);
        auto duration = std::chrono::duration_cast<TimeT>(std::chrono::steady_clock::now() - start);
        return duration.count();
    }
};

using namespace std;
using namespace omnn::math;
using namespace boost::unit_test;

BOOST_AUTO_TEST_CASE(BaseInt_tests)
{
    Integer::base_int i = 0;
    BOOST_TEST(!i);
    BOOST_TEST(i==0);
    ++--i;
    BOOST_TEST(!i);  // had real bug there with the boost::cpp_int. it was reported and its fix is available since 1.68
    BOOST_TEST(i==0);
    BOOST_TEST(i==Integer::base_int(0));

    auto _1 = 0_v;
    BOOST_TEST(_1 == 0_v);
    --++_1;
    // BOOST_TEST(!_1); // We cannot do that because !va is an expression that satisfies to everything but roots of va
    // using cast to bool instead:
    BOOST_TEST(!static_cast<bool>(_1));
    BOOST_TEST(_1 == 0_v);
    BOOST_TEST(Valuable() == Integer::base_int());
    BOOST_TEST(Integer() == Integer::base_int());


    std::string_view s{"12345", 2};
    i = Integer::base_int(s);
    BOOST_TEST(i == 12); // fixed sice boost version 1.77.0
}

BOOST_AUTO_TEST_CASE(BaseInt_sqrt_test)
{
    Integer::base_int i = 32;
    {
        auto sq = boost::multiprecision::sqrt(i);
        BOOST_TEST(sq * sq != i); // just to see if this thing ever changed
    }
    {
        // TODO: test sqrt for cpp_rational
        // auto sq = boost::multiprecision::sqrt(a_rational(i).); // https://stackoverflow.com/questions/36321295/rational-approximation-of-square-root-of-stdratio-at-compile-time
        // BOOST_TEST(sq * sq == i);
    }
}

BOOST_AUTO_TEST_CASE(Integer_exptests)
{
    auto a=25_v;
    a ^= 1_v/2;
    BOOST_TEST(a==5_v*(1_v^(1_v/2)));

    a=-25_v;
    a ^= 1_v/2;
    BOOST_TEST(a==5_v*((-1_v)^(1_v/2)));

    a=25_v;
    a ^= 1_v/-2;
    BOOST_TEST(a==(1_v/5)*((1_v)^(1_v/2)));

    a=25_v;
    a ^= -1_v/2;
    BOOST_TEST(a==(1_v/5)*((1_v)^(1_v/2)));

    a=-25_v;
    a ^= 1_v/-2;
    BOOST_TEST(a==(1_v/5)*((-1_v)^(1_v/2)));

    a=-25_v;
    a ^= -1_v/2;
    BOOST_TEST(a==(1_v/5)*((-1_v)^(1_v/2)));

    a=-25_v;
    a ^= Fraction{-1,-2};
    BOOST_TEST(a==5_v*((-1_v)^(1_v/2)));
}

BOOST_AUTO_TEST_CASE(Integer_tests)
{
    Valuable vz;
    BOOST_TEST(vz == 0);
    auto aa = Valuable(1_v);
    auto bb =aa;
    auto cc = std::move(aa);
    const int_t initial_a = 2;
    BOOST_TEST(initial_a == 2);
    int_t a = initial_a, b = 18, z=0;
    BOOST_TEST(a == 2);
    BOOST_TEST(b == 18);
    BOOST_TEST(z == 0);

	omnn::math::Valuable c(1), d = 1;
    BOOST_TEST(c == 1);
    BOOST_TEST(d == 1);

    BOOST_TEST(++a==initial_a+1);
    BOOST_TEST(--a==initial_a);
    BOOST_TEST(a++==initial_a);
    BOOST_TEST(a--==initial_a+1);
    BOOST_TEST(a==initial_a);

    auto t = 1_v;
    t += 1_v/2;
    BOOST_TEST(t == 3_v/2);

//    --(++a++)--;
//    BOOST_TEST(a==initial_a);
    //BOOST_TEST(a++-- == initial_a);
//    BOOST_TEST(a==initial_a);

    BOOST_TEST((105321254912_v).str() == "105321254912");

    for(;b-->z;)
    {
        a *= a;
    }

    std::stringstream s;
    s << a;
#ifndef WIN32
    BOOST_TEST(s.str() == "16113257174857604736195721184520050106440238745496695174763712504960718342823532757033064753153854111107217980956972311094371313807551987645270427615679688389330444133499923357612295105472898569728180212454103335089943629049973591907780692062057296552903280552403216694239075203891327355460071271019202307459542499755131303645773654911843755650169520801985361294149607500956837794546801458249510087206015145950849590956971307083110865729968620669481023248557683622154370297881298560466161255588004643805849285632501063457275606556201834157077069866350431709941244149430340376804687891750978965251971591273251528666837509921501820059959278974772955137066499435490409471962069956797070262724882828175396608842375949253862079040514343986517421482079629239951733227576757861140019256666088017481676787816929626050753513514197997219880636635517074110811110090917718919814526080394093014634680319034280918429077805893913799277691975372698510166677624523615113420055448312509654324275129878416504650858425229867602462924196108810701050280869433809450437796353064226137994659354596448860467864613898876433352470791463814942785502343393473062938759017813105282015317357353936794982542364760489912329987944237397830950164269372928014639443070854650822815514356651960897669142478258221975915064919190375531839883496687104268095384564100781761981553851400836112905388609963306865737671824507168252726831850638694385083478775216005992042813943577935491651062098935775915832229588820317867889367035902796321364702417695064373176131935749829552011220191660916305138249322188182375990720523193993581101039054797188073579289719367633920101802417328162711625452959719023888275970325181461602877510137836219269753293290552689428123837471997147144676279554641219338382818600605281421478609887659834378915030776762175009582951300819040556136027426184867045130244663144953753637822529952539573899772230761617078236015566109248692819139423308222674016049972253136330137814775383241846559753843852858175253058610850847829770607304611716124700187691915857017825082140844518926052368333149254496169541987863381443150983371435049841095258420360369083090103295668638334162824653920097285055010378770414275994926509061040584889124837133768897043968307127952138470872615300450165518102683181254005665179713318415328532389713394405555327504617945823008727675119463672887489448804028948671392868411958445081586719122974263349688790928372140143387287713663300809089802349683864622705829708886636287744223635122172790989703032669329884394037058500143828581214950116716860528315076226477760817964144324748729943067269966484491920136287559912723443616218059824705057505221252584287772642059873903818958395542054498311855040504093132827278983759273901952743640374066833443129339180348794901720439121062595011815290536015800793598971588035725982691325656250421658993992750217769570407199156371342499713209335403268331926928188925916061040172477977503083591547036451896298938818110969658258921342134546078979813635214571553241776199842879454073915459154070443752256871790251807688080294183234647980216888629693731884483776952715044743111932510417226055752254983593141687746322886248817949397875616943177089463482273724996741914742471298389193274629178895751123671079093083823859862474218781527382088357620133485554026665741444384924962487491098346254831515003190218011693146521567017873913667600010316023793869684989408495246498043176139308009095514244188928518617472341476450718550585757427314736099010854358912574655409776135568224967205992618968276136929876717108452204609387075353849590890760173812701782860785041170295447608868245841325130970084833035387972625018732615336881865889102346618250302128107123931292918068737118344338313545322644116076475684035459816775808681366204773537518457467006185593938507894394275319133020246665548824289815220177922934028682011073709243695540220528797188216035063505220992550596941134052174060707304493901052826266164853364626816451469256847109850298847543378453288094059009149293012009178558874974148460461498624809990016284948394870890941344591524747761613600260225600426568174570070045347056341629382557166933434677222614214042092138757715890532132676913787639898243620223799361106862973768594284274043455832279049845160465092789220767646714112126942588742429095504819910231371604370996080060100553100946043950173081477095804496368756478770825917893792367184587264849049607501408296584301947812898746674446463661390110084018682359861055784278997703386598118473386824411884425900743923891632847704500432374995763635114514642211793321534245359832625617218907285949846958338171959464305088922422874915346835163452079196022399867597797151875270498642358977767549548630912843719329065442626372490328088854902525445385704617185212944852828890344516939681736013428678388093318717099393029176054922082896708075278499249327762753380790290331022167959046721733707106603767071755800178878035216340716251277802299688464456855269524478174569713858648568287605824625725224181933891729771334259789489866255517134580570061673257153156886259038274884109335731435506427977689573524134432895773467575553414576194129483412582388516519520272077075593453453309712391026933218291003752842366964826392346249973686284107809735832796709401614378658616463280761013417942978636282203203768333403742037291804901258207555712830451794416027875524272256905586115783507382582329090294154456685241393226382863194328140271376402662152619926621396091859827640193154615302600514682313044672676692772785579861546932337862203629144500485144214220920620504964274906403793380400759683806624256781626139736423909814831026013256846856732586450576393224614214184139324906423745800829875492653101863235542609771582492888109814529526633626102763297644073625487204227577620158078985084218756865575287350465291900491632578645150534642450631134519553694744183118306801392108677266438369422557597062553304608113117614574553892362663424648068025355016607192728787088941248719091144590764576296086737213349155511388871075453626679342507908498924421125135480705061389573563521574374588408724970911316664858091288764884218544916059184427168410036945535917998929621927004264578666500199086043729403586345112128718657515248368913071819431167132071087863595825163699832829880486628736325970480429825203771271646270144067855164136771945088863705208212338393890892339089043039622313258084119434970801031873990546488861948620686361636593121938334101829346708396663536095623553387705273038258582009950145521716721385433756599974426047141252426463813477065837402142547417568394251282485080521381636783698643044180238590302051740235382131516867839209321760950551092781040664950530906393659250310390577375443140554770765626200352591328118731507419233418008195259251202450519516278233172857112414456035849540457132279290528779704622758659983804569324757625808281249658694396781554316393777828373578209339939865847464428662506942945448243995933556838514100572270345840987535866122955269932208146609982766788167050411745972787651653016830080882640689084736114935616204292161454447315719447396478960552299510032150563495711998967213924924261204026578607397951827921171653388147547784366789196624634279261586879091209254605209668016874142841942044300834991040592909973350993633342914690979764928561803595111360263398245785164180812243072377098789529799839095692375445307278510309423391121075487096507316989382380761738773733743090629079470189911572246134970794415725705486860803608401970618647845484848405095069817751467957166796088955017941564110523693010872203757767024879518970026039482286777736274679858798696107948697965132605360449712694500763776264736131595747176257264378385555977015978818794653743451939227551940799300001934352848833919345758688837936939611845519565591621589084295505702543557086645415628615548218821988212723318533933604986615890456772824146420122586057681135080279024654828927716024728152813567431485547958876602767207539002416214122639446318806319412056639265073362903063172479681260716477067202620345532212559767329554760893005200949248589965677383129354497347728742647165682572570830498173141872137976455293717860729652965012971044610125868454358096653555176931556520771773929908690059517059679987457436987262273750125465393042661670626373191795950905579659840066947170524728018719322437663864972649660652137470599555666725142812915016465847178614075083593932991376427399472684942137512658720737576268521632975069656124582815035489601079449210318670149965079822501528403351161013574511977014405691468766512419504137272146292370380373892514366935480048430496357163782041581264343926465653205116056894985701820364874697437073617253179973102868355707947323913830472063964568410687731010929002697131294207196369741812326452371052844029770704542504800744176471756458557387995227003004056068123350592349849587206726996688593251553075952578822619000716568816542363735887809870302621493375113294539382060254211753861190579294066643035755863693886173098320164296643861308375363938474140779306576386862513978017021672012349400669793627412856034471490094553955169805529451669174298412950150850254478017871621041042877793040926570905903164946327555564732964165632731458678836786879470211438595161203901036913107683861647374778139311469037814816324300061989127809519904585473356398821301193866485955287121496624107719970626795200120612559172719663877136294462161209594384286352697882825627400553624338731938607743807283836524648520871728361188100583654791521748175350234812324308781244644236743805389248502737707917442558321040993437679132877756762600166714592838947363886750701164331035496359131715165127547014177732469198380246299456330112601395030069175646690896410971416061054996413437172166657367048279714069164791297818538002601798312594280154770925053182262415422985703712465529129799871565112736700493670503669629821964125203833106740860770221699714111237565303800775313708475720318625744021711808350507918559225700066888577325078229777176428642727359192085627266868386014920582364239766577915812515837243944733041783991166353117328810061472981278928493910380360774950642679147041223721830715711114326628526241728691111734569574696245111443633205635880837641007758654042286705647453479999072309460597885203327685021648811551182074145033328233201616359885504451416192056916527319522027737938591828249533719115542830306058565485211866949730442037319065066071188409576398902742104181290340140616670025082738059212514316121681002615690045127548530828647823304591628098751184492725043199694814145677783128539654189327014333783344975807331793174911313476525515914413508275735185947084418163235857253639989714502299800067382389222874573666120004840281905834903812928827507388499434728083133585286344082739738277228630707692330125653826106743658263598367244205547244387614444022112201170132642471027877617528525762191306557861756797917007678629902625642613170745673376693840513847761678572020301677291983585349974686542644198832714093326084038219973754116482309069016131785074659874280289235059026942725935819706701264935694618990246100418847293138592147165981983424047719116492694892235758328431720451252036781309472254377089996160754641336772142283555310193420129993736373981798185394494154194139886942349242884626627695145637944651910943603426272643785626820287153824743828680675054672201523835454936459420842216710840149966230539754111445212749302013658874747849766102631275922326141257253236652323420478625229355132520998054618429633390639603645105517752154225544172732952958578411368480162071005931282394982840379690668301921845417282761681137892533293546818211897208982306403321131455163634527922634152763973788064494818757730826876361111776378220459670837674335147607697923788944553603008514400693141822208370222302934755965208223389626362892852356434100402946973137876120906766964705251209501129944948274772756921857524766203657641947430633360270472652172204782577924887475034606642791115695067774174405268772117626165844023601108210166117197535320930606130805193178048851920401760657496337034998270148512837588042928028622232452754359801549386555345474344625618614094089096644783763800716806373447645421500142419998544123558509893246899097116566708377658077107507327035081904307991991804550468411665752604222917418632477529295669433166643468995557602151108168766247593811449013793031185360045458384923153541010492084351735063472929842302958211409368168642445907157133838642642050106728111930620127281883253759699201702830749729908587790210094767508520773344999474531150558975569804372813443859628142380952778669798006518295889883537870330971806443619576437084653576372046893840431410810467495063074899177549549765478392280872067262246060586960433199487292947701140059142402567666028387027031621158753180603384271166423681775122558262777830937328618753236095429230853812978176943468141241867925928254686687934543986925205764645522504900928622639777377394448744246991363914993688426260612772294511379613492269800764229636361194516354685142214078555837385692055399550422747160388448783164023242944736877692198867883877669349766312031505125342618158587210294291436922785517171028415724984971992733256660037585894691423027160168174776733210546671445905994571491511245722087019385561304668966565541797027372221594683858311680472505528784156180135135295163148128960053379321047428127200942639207331483131676808339277292350979841644863865262431367620729236393766911198365504690219264398643762805037959161005322767126589546436393494528280998155568520940615684411170898745949146339642462665245225875915483337523239846667738061865684234325478942262312888744735900989685455179980222685827919034227143955530808587837496136249094143183636735676511026650730664478561686206976693106435935328909596273665055251535911353011753557396394500483383650726181911969944305122311277206823917016603494044358500694045656404123315985364233665313930406742090854323516907820090276739560961781799613769742324750124257366617554771514704068720774975981354092705291779785573461627141290804137112211162778000875495473271506505948553224936749021250254200745669159231422325722591263257285960217792315983245785388316685918678332276256179389412608582512143643525027920388751702540281806469505098821104548696487939879098120753148180351040504232405186865870370945692747824515295495985348147056139382763254511400707577720875010160843109225374666599234135016877288629586849700550686964793318551903174420820697937866159134119533305676160673753057646067527696151320677761828558616835796317170118374144153627484133391835151755708064987669218505826732979913542865821890443424015012080550160589522217652796485347544336138700304614075911139873257197441021033462976008958444873245411245589106803355019013832898237929930955627502445932328063984227125923131561847625308482419414394443180601555767609711311087559198853606290167019685786823450056251079222395625169006309086118708033677325320203968586919924589922396898377885207461888541962337333694782816053864489692980813353048191466455298284215791571374747092387552370322210166900202993218652112193418570555180862819103676436529727333227276997148004931559155948050806990503660123335204883403362684526022568624337406217240436346330596308266093209060476400900501736461866833734721684113743098974014126545713298784200033212311046363906402437682722468862706147524520180612617517346471922273350966161722761120740476082741542044983423078444274728318013662953684403965367951809405919848230074632428438325015596151549239910119214080283697321324049390268426265222078512272478813187092360177680944815011008988016504613066344857982241662543766424957465151032435033534463426010594770563961281488267268706418995653918080411295807051697482712993395741124043554924346788670478671492757704038405330601520669980771391901776576185882543330315948219174420947487068531614185091707373599505760732217627065777133041579974407907125837267208533840797090136198805538070774030210878094190371249371981055588377353074995281634320002647054578003162225500029811960672186465007672830325748726949784333913664200225697626474535621483841413515083504956184266271390877306176727347330187484973333510980344690047872625386793499544875810821414768769738319399150839803968318470766231632066769327531130762627074644649130204786526005866060615281804824177101685018240184206997772524405532698271623424841611142284230900889020763447071101301954756708647611568216578737176223564135806223063683265381070325052445480230145258070042568105305065663020094945608606900973587424360221749554142756969249273715864071681578590887604607999042808968297707048268999904082324268495094010801466557042728178029022640042656810991230993139513842129055175128969653358917210438390434139581500910536274792698594317132875843870957016735530216907362394319532641556843104482934284778876656959548567764456783001879599562908635415898858311456240476773620585555344590807987152068127668034689956648669994206542664048016307836214901135295834613801153247643658100630582271741201570270808437105436504503782537814629870284465026158841615547423364048845500201014957454037204462955674604050862312104524203011680544045023525994623675686459359580261888128947840824378535198059322177257652535615624320463088199043094202026934409205713886851708201930462163612755000123066997643804232730216335291210029549280678608166384319463515639076481804131675284791777199019909696371867051271795266010914817358426119890461015898635574787165094043006162336604870524471371030174464620625751915194411249905503358242066953762631713700993178551080186525919789366321304271278658121485437460836319374638161490369536587323427553071630452891109544915285201702418157370604574958286027703724696369341853223943354718492097642593325444780743868682970310024765609342494739337628395429116030436220089921399103503716732260334940757373972466026379170046718770502699655978592143388941803817875573206584577577603892391126288150975341062435633328037381001802715313087203002468520135941520006398941857294348070151548835655640238493071426585614661812047850027350324883599555435147330551128542723022115461936064387066014087443730152420872248360256662077740235321589378801234643609372780257755415288985401052406609444416005122225069117331581393952818400980803060769874033536024289125951007264097707218662139987799114107904456207965031325490656774371474437202342939183047411473204076423028352099634365966445782122377780452520863519485660273948679885652203147136004430583530694582657742915805516220169326452255513822070023244436143824921724913303547015418964621126706036448073154025401300997767860171083779303498348861662171771299770713060016422703281719390757161516092714122653517584650372813692153497455758662296062679485058414842327320972418377941910931615029993490538826447984237212288016849023779243483629587494002312740123191551083737294496001489710037223907390326017200678242963390317536036900487922851084841071020445052673521569041849682094721554711885952823695333367457973451374071507965491842933431248116892356100677869900544469506155489044772623906721391011334771041849306813657556859289338043411410296431800234178209798153476408805616712392786919272431114217659988166354945717434473388793031586970236229449561923828149750160029515851499861560916475158670776410533410181557030008096663858289664193808670816065113813423016410165414766617058586516916789912325953004524732091073687411082706909950614219618351130273043299160671063108199868361774557412371658406616928625622725012299903278156664855803025238357295957200884782636823136854622027534983585287738898023386839841138896619944868698001451104719025046111282838758216645148438720171851110428013877174809618445155736491520745729904720523246556082724800657398928746839986438734915688453853039675042133490295145835386108884299321330650391655985424533914299037741683253428192908870925509652667658720126312233896557590053248026040311443618758685047355720712880590961516101607474539010722315420569807051586702456270515362309735232500200398034728604816704978661170296603654583138773523007460054065887516544434413978946601727159875210083810599676843227835932997285740075397993950267721847892905773590352149708586854711084070957541870896790448349675571527983600679021827411806196431508606605969536436343226414585771659800318665646821206734303194351407823299097340039654693057669905441536067495132192561427322039826304425550632355235766422944903543748768406311183323429859160263077281059067063248484091782775322273967164738287644688805953240905112974691226747087985799681406450161694403055589456505489259726361778091269407893861879115080331745633199046493657013524098669031832553860726864006228326588225290480484363676746575187810597009227047178615664399401875183734811954887981036159493353024161758214677966253334568190436415308366399849861034093873192270315844217201697813565209227337091759421552741838380721225606983843897755873943319444831582473784736220178233524448000663248800112782060451282188812640156154534166043185637728275224494656800145269147487405326240002454665000695350583164896744668898174403818052498491766451252091944255872679811481985535039482455050455114737962741723328374895244156421090398805091089776965119798256551260850589125447691956216152918842947655600441563954414760451586493780560358926857593880024662215889771865252165836560273970906476521950202528404602062371283000022934716165041128187914152610524896941707407221753994073228711011145256526889738814957168837416585906704837778090333197266280914917945945418229627397793786806002529254662841997250796048088450047647248782961895413432451577808479412730119918960143752820968994109839574774089984333382990160173005735275712968900714241583007704100702696114918567285391258373735580858083185400275043534067425514617729293065225083065016733022499743958009250880484226772853839405891976634374451593155524122914576700631711226175307934685061830339933940197781852436555195159952457463688337113591009088624615674787480267757603756882108927501376052642298370655244132134911337010635291718402515130463057503796408035756626618758229190034319667523278624054122493005440901330596622753645084644435916157179929071940972394533211845731003027323788864924307030660560273990663454776490353239452862217976344138514017237639777544435530340448465845330889676210760847933105703466837802583640868648626653518478370621469617789239366231059973418609304773802723978620069251384058928856015008671960380623315276332139257723382777916908967716057739042180059105533590805921459852181484932716837281748023189616105120850957219928671171047656045718333753333201081263487594704015652256666517609131276951943326706814998312986442880105780040222898275053679867299529606852364008146563759436214715122703952853062118924288988578673629523855435447039521741601387312606740279431319187009388258503892695013482280709270016346298923463764536962469408008329522396337912597075507853288017978606385728031731376637902345914248172233563526143889766575011501195896803301206934608655199652201051725601854881870016223767962783448614069323186962054616839865634102258722003082123534608119116978858510974144530914880517413209529977234247126418955499335670889797843516811173269701124266478072289144158172170058027436109228769666460024676518776942773638176257307346480441232216734116646862579436484792517463431685313507664324678092937414866101763842977508792047135407893725728770395624491987041705014209767472443715360218851354843938158665704027052484247158563405027573197855266010063522766245080868652696701033448085444727360587333217001015659602666871277068263875317549527758833818799437637194264268394294152028110178420332313740496374360793709716016025741446465222550498799198857458840421759849924646878725715009057083172419529990585268317917087338913277667223972661829336659946045031402992138450343238200083130633535502440052517958462675785379083211078960116239980319816558332556653640586541156610434903731793085155409104037836577371366643295531460320799726425627431413593554865877739847314988733197652277539707821953382657715634982270009019772973735652986835756612579095390433959508208464608403883513643367891308048407279059342412470690352746052804908198666619124905026626319823012548652133983376231411923140170876953043236297201274258025177427713744042675336219594821253250026610516838138758362337965377356843447590506268539901309408265380139979067746112527830734778056287470928537011125974065558816539178486412879081281222825773986147363150406559308622984068941751289876731549276217748046673546519980971212975819169420603754588373729989869776284783413505832742993334238580227141137574232396158336021212115635511232982413636078832197634529841968004383062171378533140721762021871096776116621898371554621322797737446997788605781451604598548724421764773857754599877311934510777240314723679522899957904387294804556219674841814846736380027905208188812013352249461619658053965880002012474740979288303265403133118708869080601517534459014292583491460903732740245714952518259444880880818851318235708285881799008716962687420026764312233140315452307628668248906073259243590974746867509063087656977613308082374548157016477776958582035446252836625359602247626889565913650781861401644522434466173284122311185023659568773339287105121482423021663597503239308989176568573904795888044635584325923678062519144755387462619489775957317974195520913033294091034350975673707620042205668975891921595816359950324644444581990161404780658892021549388832922106671632312197769637117429011132294851387723034376126907003843483646405998759538814052771466109729290657890275958776510633926455391818545131485492568531609949064791153985569842510448419351858051835125793688915203476242990681248673955896407167303955578392568786032616002407877588048711182183976026437504427746637662154033677569758091472328769042694220235681040477953950780207569724373104757230054952903127595433356180167988606726619460206922988502249405894222673342388306613098068804407343475831095303847205026390718476648561502801809297514393759346232143636534735151570427674949999408568792174522063283498623426197687985007338395089431714656156537042324932284618713440762708146569505542089566691646795549955942443965412195366260640765470463871746592338124169819121836392516582760089406364245822692935413677999189114050808508660078607838433788078035136979874346288501165533200267581565753564571576288365988708218183958333920668908740128382368454046726771824777517988623209605047285482962079847969483702776467096565438563647223490440649103288541673534346816535851354884831438539782862218809387337282430845353605022731569094938028229982123328582739462059037197660583120853858916012044881188595082236836147345560860288864977588966362403291015086171869155861949454628475344897593375423399657314856625652822735935026684788257703744431630037173209641928488322494726093996423373830544655277722884659356482525328646222066150881155665422619502958765262888120310375211613738970168308106868070201017352551665735043443610938605426902041410944403396602792591980181988675592160649987159949298138864644373475895736188369785621768061787916321908685230415943318360486991964484571480648913183219982821376086288833654283541529337173401961031487676949314448037642152051634193142900499024736312203614499423450223236752951075279932749410708038651938262017436268605551863691567016009440850649855698665556210575604663969880416797062717451726379280792416012425338297754311371869404126278929569165110116030788352539098738719623400802704990472695130598275763113885343971559709986758620040736055548866474046640816411952238404626496881447203273108623399094616035945119772337024355276436738693456888293165355826434926391271333729504044063445831448669036595540877908661132169676560299095476213215388737285738004972743688161677762349660411694287783856203941127059859312944850963364559361319469658052465582307435296549645813927762573630459036269077365748291824735094157064696066417157357687452756922422734618089537080483812020397880192888112739026738849852858927798810801173023649735126213215656863460596939102663432774567603731861529885289108985811134006723934675188624941786361815183784197684787009338249356171263739486981293216945696329972072143487114568702612488994452421322618785297950072405440191628778621761740455752432820192828723351439266880321392827729219342631011185615261908061235417092587695612425659629846624885146489663681517105394965523331030899408755061844651325180185154415355391058573671769603913366320966890717389936815997897891545530304828295132305363372828969357225783226685887270407465087032049336754441959752812086809279387739494677550499684763743269211201297872487477996121679168362371620047038998901780165524878700627775042977873789692447724149050374155120173035106881707523076203002299094957386603771469279512581695197476298287765043653450666623693268494765381940248336042797849155215927313578595859576229239549320528314495148277476557175508609059643130401797542196284968006361790409340734622800399759879808423268016226579741492649201559392842574755186542512660509177093789828541462005640222676558162948188709711872363603590001323278775655506961432310455985831926926161591654290867873686815250096601492847655802591440963339478017971156779042181997252271499320073210311769002562064035772958277566933192880926534275793171545734587055781576305143499648224402862501463233720739689004249011234741345403248171278102987789292540127007948647485858916625445299030715390189123191261854084073796009130586338070718068926955566033142472702507558624471361973654606927668165914780609749546167941341127080027658038886484545337200051540889065702764152362831234672751403716193538457512697070537301094445531979465701812190845825260146008237049458489019298079361626821557609625971976076456048763664229379402490111384453698080760559969998025364317619120903789556968006695211979237801443277816161870440177924236444506800394646699400032765399602751263018097599539443635394805185560013784503078004923858771074419280471801441164107307680405305043815633003437772322147886808773380069528050388798331285988651871763171927239902716799240581972257606807021547480133987817869861555401564376448432643374426830266532162759178167772704523004064442183592473355597913704317674684669166811344099154121249191783821932534110460569622673646939198182584460312380365855875249025167261890418507214673859199578857601210879250090503373475767074759127881029789555723990463670460830874180567393561079385355022940392600093120117575308160619399203025833248535585072637266792372564314595865996867915218927399721260533577078598445480682642448232529442658479791611110749667840570619840361603542460525128148359953045007952160663982580928747569674210151407749707912000147369434231594392099137345"
        "58402515802668289188938679076215653856394596567822493428249787379823260331054534560056889915441720408151222460114697494536347496950214762374416676335372343719264236734075462951746500738277648263005729913064583514535974416867911092618933291776486999754995070220011985156927536167030300487070980145505864675238073031982450196170905785820877667607592034328472582597545986509459244226175995606730532913679940137520243800555638422277025778122189200635633103469726438272307144257285970277174794712389726256346340011864209297726022680008012554880165923369712838053627488065028656893584815215836327346849234558361089525410222122391358581339809754658825151474821279928555817049240193002437699910616783444847189391941531463807285540789280269737885972707603521421831422235986883600901033686757466681152869819635368350561811489778258607711299568286507379051577894214660225514203848615819214565655811654876873865882817703663498562948586796241816041163225509852616040015195699469438008662036515580350302131152076640239401319272211071834458874830644597784181373779259005082160966419191466185025314364859981902173391598545613891943357959714274891542565177206046810665796423813185666098657843966835582281399434508022745365810910412558171621862334569680451562940847782979167771769861092273841438644431138411947390895650891206497147657452623162809499896269010388420164981649520616171205527894056570453726435280031834529004126617123976858607185822733693747858670947023516804442244560388135336575303962911491766717640303214710819688530280043152935596890300791674677732151502553969501122540950676467176283502983726389330015715733364555330523804363429448506250373673506599561039832405826079158660563129938458225572069818380325148712017246115734891333078037801325219737774165318838038994312687943106647852842315942166562302811947797907722995595094649258600145960851638450587226622561243628935384152584575026395710565313736826521509726298867802700880119627093226760176141100678216288098239489492505590142790857350919491954196939574673791976672908913163975809273991912131470098007180232535936616310220000027251441307452525687746380070783089950713229673523293242688875524985736925811779545243855851174771928009375592146373245346192784554282384188534919446421473302756021520238990265163673910836727761397979123063929859017707195974568725165527044232388381042132989817473992664746200308220395760142015921206627782340466277329414411465731008915421504488499008786918509214222385032777421563543741869183039616603297780319232922592587673630414402937920314193908520204551934559171072906288568150775011933744469591676304055961335401612583639012935328716871582325524153583121547478363406162602202395086241189684896183315159351144404218460435452691724281118493444976122953369909608444856233315249571188488597314702965099647662367082782931982080355155900628006881359299349368003543710770269354488150881973013889435966605898738949376251198729263587583249850776851713826746803848790716927423367095230310010720426341015780023820748735002429800874822330451996928715195262484462195168455335732497931786041617553581808768669731663375096023757213816238754568721869127028700384221334922881333886221734567898588987030517250593233780284056116960133187814971534162294519565438792080717204290077531767710191905610671678390957436214557719183902330895235057468191393472831192766191798771396068735868029148497228165119820765963398740075426283068266895443551145512172738801971172769404816424723412287154533767459920500804838722796274791978680071936953843628558766280121799976019655561927291449057391077276103958580586605147894313679502486106712431666005266915567911732298741198471892651781692217635981102674121743070102220940561633788775595264458022680197284411184354354850467705609737382223421721489885904853746316066440550397363379728838495924100458032176699668129429962466229427020498738378965908670184742983202676723004813559065917570534878475791193024055820022961849550140202933957590357275823750720254667370406320758483378480307720146370461795574459674713228116364273566819850363976345972477211955348389598056291481643935636295938622850969156529785778744800856168707033184470786250676134454829092060052452263847187168353564784128642223551569281334397189062090550526170767445779021012768121538023440219120415555461481108511692254583703738509503301799288425383801546533925326882997633893540954398571833327000088817874998498285267219068059965170896094379036746721376010401926219744859250364171889593248766913508028824195774188190355307217880032061386351757136052031622453925672212779453101995176388165793002486507971267577070138311209500191855738563877462977140843160326480668057561900185354656952557106223014015949974578269467714157018704527578507710377069206420259994952725852566559437117943550452193500203444867444394812674942196072043464711650020487199090732160023887990130835745162663945411713390004925404634906060325284313095747120717127355700510464724628720679933573842532530993997006929024544489684514050483033754899799166491546881575173273374858780316469644711247623384524576411498342248399168221572694572970386224191533995721711556353095882040103401632611697197269604880858154174386145612762458990699734676036609476690204997325880748307072257153904050327519142497452299586870994462929805251429406138047769255253682595044435375379438897900310751614904602153330735109772770448228650103598877095118612191936608141870698212709745368231227220239310923873139564906289067014484784905106786143580195841093469969453473720077046750396398156806127191502471217277889431106035481149233986352491161176934648212876905909566109633970454603245019833689615651668428617878092309240019090472522921963477350375143664297370377297370612605323640471379737501780722399254865954999083251053087529217309715266673153672134713809660557556016319502074932278093650557439094934450639366672506632426804772626099353033256538034568921066797691820328460521952407656026826166792260934158831234875332446962022129184049375446477660953790549812405293174952815486501997371393519510842421435447633094853038518588935947782119176711707962414657704444610874180544325124527629251969898288038772675365751440830053258991625058364421391748309562743492928544370615865295395696304508456474237146397551746378879838902227282003166977509377103924800698014712596137426626556702919192246312554858694614673759638053223199467163283995781315900626665410609285120465670040632743553560509914465713281691678324185741712545914205375402770251915996650087822165654381012747475815751989784526916463276425974841188125646932226885279155483999892012174580577543618813686816248835722889796219696737390387694601015389085110612306035716827653333202929658315317951168789201263956604454688613508402172303391238734302958670786503206163412696338106020900139113557310008206623212230555901985426200034605753002090705320549312531422472068149349942748456583925267740146997924025899937922271628611599359895837198115046136582723625546733035603541291845247156211995798913563651404116338373327441105640305881499621963226368594432069389723045582584050243582666505505781371128720805159925667456187663808217859658591316474948790532016876892159908081977948245987691381673707111718664576859825031576636631304607598969393220683294685910442582649240366809996852357015274723445935353306396764625494474873044515956330372398886704174937016823028515041384104705891716153135644675102745416909098570746425224926713860513025047554464787160230602495160389785538027833257958399191259543752374258146041536392424000624453293683816385292710614090586077307846242838002899195195731241108222858413199303867699473370776569076054321298879289927454885739506219081305863117864734851526839393570429806800210122693109331638872990884310017328000184251981530124910740729650614787415225481612305325087296741680562995319433171090427735135057244083258458665265538049320273418379955357660238298503840885621551658336161478748806157444570150078837686890552245183559673016197058031231451082588518452885910098316075838913991642803568172356866581904658823225395364831018392638924132142753960333752223620698248183723182507955172015514201209637239037852933543596326271709407950019274950574256466570411375743848165998728890319746208513153002227697238256101064006250045868199562393799853815064274598159245385442676225037055781932762710312660594411119864229693562312044204533217221402828241662664968448612371390369205760585674052780434265358667711425393142581450543879488384672899458420126345814903214810175253344661083256350301106646130022133276916268530446523463464773047014517165344721537669138879198661662842916657234646178172063502804467244051333742894907405220475619391570974757870905636861479004462901352991164679648501005195574652407018699721258735908597523279346366625421133313296255408842993068686991351062131324770794836188005902776558241891124740215758046630367851517993825539511286571856947786879415956671228908959067204038551354993066336228389913230266633508303976156700108514788411544944920959208177699396718641372117871960467967141089639082714301434053478182253784055736642311883658969533901195606959911439924867170694617321590129140208221724905848139314918085000169576284973764040519145302164117858173551846313475526368087406019492924734276585200743361856851542207753597105865543191268512871872626670803197755623889326604616801535027355963542892539388012348645572476209961536358218588650435856375405452338416229721396655045395741590096406933771223548432046310589930339621923800238532791344474743617531201993823569192023587240583565261298918696962732784739255271004945779992348404360617647721703914521614969153424162407437791674008804103899497107828746821317903133891912351213128806938794599593783840986252904574240239966677262591025015203968481257724158249398222423735950663835240136424647905771033197665997534313476104622052598110734306043297422864721127957403879874701155908586384287089193600494691899129238956757331045582200679974852840584361024865152287042726250170788624432562534756163820128440067179568353882519893160676142639892866592644740164334267212280072136099683619800316900863669027930906575665866870216907067982270891504123394912447714737204095340308847589123791991625619758764130750751946850668815923726383938213478258830484652777572443304365374585671525299628405738627356827614717867216262844343403238383846330137340281643480695435917915558993262379465432639607425753991478901724702146635195862900370857749955149180434962975652414319086073737762088571593376289981490640751483561944555999456989397151135913357453082485586972476030713657337901751136205872061205602200020450723005277904436162497326007150426101623394488429085748672492155165817881523049038482466383794399123913946782068715468557846736820401098877802284112152635494183924701281977321705857358280150635863612333862920737571876827827380604505086981100523448125272929564972561830696393506599323530538858238950357607908998311273313225043079347505115711501729252143668999322052088182478365693869685834172374372629808572693070381268862012549488307372265450294599186276665191788000531565967059069552367685823559772616630719002985695307835693314851630227104196912557645686365890824817361272089465347207419258077547088803091737242201544284682911090544038623317808014344379989753762508522105371333456098441774573193036857966178569353189270854618165700131192145031334152944439201722152886069659226063259097980935330987092808006950530205585869526266648721709613710067149318183467158917742064253123420400971417464093103912966617530849230731617655783059279715551889651759030340892967306774701102604713223467928064647827273941992496373282267689177695991507113896785141252823980839204320347137418501370393585077525679638443256842918870275843544713097936088229034229877225479392832289413262079374054071638713117326148657818821977210976344562636116087874740524987311474376998890468707409221044906670318094084815640170345340117771769875438838212934166044961793463470698500701666155821853212019029156528403952014013428896371823045419627430611197052410265458000460582229936960385195707792116541734275937269968608920588877473234989455006455646336246270848779574104321067533013646930150982057120833761936982404820574753248723778086838742412035137713163699940784724291809846332406988250156249894268838076468561648017931209822276757855349561239746431311406381037811754121612572361756892994797278959593372464327087984233758127027275267007305983724177303041000624398907568341765454274687332419282022779379076115748385441060277861277968140424726675517427432229810502079611364381829954726577040613700437472137919883526361019594414533217243633977535261246294462385349866160747546467254685671143680731942749827067821727815221888893145515507117585833230747637941573391212231773936981340321148790678846312537134664487022286664695990703129160937232035408622677552907678045044863630303361618573325263868339358722990400578073293667533308504550180667996119586058997574556050747327911962972688670860938130496527612338105423879431154718260776014927898239011060042998849203912501531288598068306619574836165394596653244577880635873087132262965602453319962831315719799768446631931674145791427689752048619949552064357910623579837892120255874685049727799696453551444603498217904309513668559936053928226730853433627535198136831159196531822358740014084582990167124095441378031990456510724014355538840846301280158817234048198567372220437135765024287008279465973902938879208230095023851909849521257015516523986747018990911371869186052443289654899856745892889797865153325151549444451795359332806552454899438544767892392798161203249580552568806555676898401198657977778779060808411678705578044981236758297354379950598390305374866055586298757713166565184781788553070136325534330154369255270444366968165918129055303939478098479627930780515940536778125472498340675103871906621129073560091592483862366644463632204297805557363464549486967023798518631363757310617632391331598069337448611532869754725981829780663932920717626714870323858855956902048848398429901565108352714765505120246643054910591394276772665589369965847668932616769417715237957154485474910180630483816917925921799562777451811340444973918349564795126608816048120373839907234068967329304941437826584263992409467784444178122587579384921510370897572481397184687613948327667569802610414976617988157220068801308161180100580261505356590029560207977397383592799439811905982771451709257623939649950968462721150885040459258518847960610692622245919598860786398696171618060627066645165269561176505307688141858388145598901387964574662350492415916279770418030021056349618944273391174435258655150432193871786640702870013924272142598255518645673837523603478148822068756184027537862373871035495438666589972676830985981152541634418070204923314440284090661708952941129706458536179698923104912342493875506099969697598551567515965944250369419499531316530868067067175695123447545430516808083479369769316591307028029263910538731828845877368138041483052169338447542375449568167581556788248157327941681411997585523895836539200335032930181528949389091919717200852727850542368512990460017803686780572198384355541914262252727666819873952261245081273402141657298845394662548732375046504387954643917782193646867321611904780755268392376915396137967294623104133544114012231571244812103239900177691351122150237664313705955534128251225530268119833657018454543887232375167575492180507824063547501220376717249688243951324766339330215721469493351925319660990194666260827273453935396893693340309509166655484138562455549313995997100881931667763834171569016367371288776438587958997076360388862908083247576657071258038876015862662462994364655063765587399492992559824479784535016948379154576489347632860545800113617229088075668122039383241357590921133738668620122943349437737278842027529712774940643128497069646979202197733752333391094806240742668608984805854075624181848144583359745539768989327263373740677374540687414282314388931237243645817465110106067719860410844189656183180298625240819327397663866946582033910170183411832640034212694613559551530433140885097316064894003500852089270719537242104807160109968635758142916504884310129551640064107158310119538388236801153985398327107256909264379319589860767096507444864904980941781483345395599294058927478953351627701107602686964845736262842690807158824798524417409816607943130623023731910410796795116833114875505380499211664645125852072423295077881453513668335382413574562963570913806804278229531812290840223070572374110471024070576428410321552575815548364802930744425138725713491802900561572802649126882101706111360572842227510062351321365190686407317167642637179743183595452460503374881251646270120917243817907270497443605136127422527577184315297022420436815607817416521780789039408474858107412613145821204124819790172602331696067582012990492460417465625864189279334184216473529556626321160069913905092077126138357758837142818392547982252905864116839738287803577735178031278688510900385078709217606028572874212543205784547960651515647805146882233985294964347907517231069104044271465674388547146214290648010986903119298157667946024631001026284403635928501105324119904332219137557354843173015974571035000719779614229246194007059457171900134288696374197783722219626282203473863233087517700644672033177490236385882894578095308204993386366651184164463704476118199236582242801563786908307603275208997327155297905150388909528212625583055969765444647939403162942885306624164286492306916088246032408005333394733175770292975852255090397247425061422247725089956591163343859680722743627633941562924248222425911656979910495252178817541713456162433406380881812152596573703049123378537946439388807367975912273796148525758878417328617391856436687147248972874002358565941040190633925768092862479179615433818643307708399892773240380968509897942114974334172904042473137315554309515520032038802502879901142404540913811080120444048887263451679007772102904513300545522880614985554592697418066628545713094234823464104793455577625588747695759665973972257780606166555719061899841413243275762930135309631229190127384947360148273646743372907657182839954483085590002061889029103553141557286445721739394946357537883342792819145138191592931336426162456108877857431532589332801339387307819022350066593251695284479079879833734228602745879988331615769908032855898465266557620049042630148938921833524498779120482293347817312272420934125399125639696377985820714045451066034415335789297874928016470316655638466260243280052958698043936431463508650936643385370893017477837644727750701981805535838131564986700054619453287241448193928393924905461025982817840707924583296598065469121567906008353764428491690658822506046096388239573439344563693198062016577611989667270242919913409546771083334622925772841461878914324973042889765950465982075284712956626452934049516371689522641243962039652875120837999166110030848290918298576502596152832283343556467586346143406400668490924633522922096019787587787442395569765365839901490815893702859224965995480170068084275522876392229518205677213985617040386716052573264199006130387208144448821924164273302863443193298376869748886939918663504550769031101937865521581153389810859229925681707832908700575454062862321123296741208279516155265548729425704505333306165856551348218114926047050522909894374644803995133021983282056258246353687992831693176483990262822478171284583596957436316737582240750586471236476501238145944152745202928414543912095396196699581587907075047023341825781993007569572940373725508520437056163300952076500395647158899047769723340425396833037541231626135525638868850808238574570253795327397207099250649284806733093898977772570033612545564841373747411366855486521594041352829957787759449668964553679617208869229127932137274887399270260812789985361331374448053671335164576964578212286727727570760683338841215855464358483963980256544863515706119377432033062393469437065161657145282161897937531273002727016983008711730038025380303012117933986890582068916351487423073883836807592835493284979107161786243587435574204486613374206673884943508435587027720175525607858776514209980207517139669118694722419207930388307236567563360850695541411965325295024782109205537531499813755051940242282492853091442809312711743460110089655178283408518356718405660885665348003673033110410862914876120338415735111841188482467219232410740905074153906737048997378174397106346264327277142302191605744407286045223090322629450787957108920638799425627710128721754282310501467456447819195554490642390889378652617987821155686930695256183502915983875173825712328639440670496143711327943064142563084605265650366356809736602348295186155406824782773255907658251050752584767466515759661852690400213691021757991891741225675245131831286515982550779533161873018600191366244997470693678276686739938648725003496826750883883432333238013508727452254688906618556497504173430036571076489822035716378601953583706585554512585501756569036874636066432201630063163387209628598212478197735205943045129817839549503331036701646798039952848719756118755360013424228414326015919655791513124918803159889948100340117365541717191920640190308954205559545819999816708818701548867216781495947829409283221988400960997003303634382669218713587405135055864550123742690596493573981650897522706728366557778665059959480996425565891418657577654641792126116254575596611849964728225580558357124243880985410643630376271861575201993254993883569682697981740508891356182006793514588437564439644922601766153780190741778771619892130368112589483852177251528026054558718300337133217203117060093334193132503689296515571594536827230603957557480650538320159733697986174158417053581046648374828104814677225632219740678613506764308321408547852790519074292345365729391042257415920343490645402489148640584672800861835389853282785473792302683445959017640652371838529285462055004254321469390352675974861008188853475071587567918616453843424950857314565551251060248578147586749358423368001098023532483667229352040498576710443413155590967369151754905031364207034390818909031561273258553118120347030500934939013939300931221935845467361332319447072737775982328838112395079483474674604315231725033605670631274282082063446828006072028144451632747030887995101905813924201689620849508616301498840461950857816563787828112463967478070157838274174833370896485227305780354631269638717929753939512199170566727041777805664165145361630701226329187230474130756860502909898285615388967540198332877131923374815548828631692210272574743853762955181809969139101186202009389521062154438522875870643089665314099493684033572206804130743158748745508588540246148500749075933212519812091708842041453768465158167494999083289872847993589137715077623713736339332460184658210380136065514191183890008072435596614587379892999564648086772010230292923802343226569269285380012311997410414456271092039432109271579083140676898111204691987299476941919674330241801206004102201152689392713587211561412198794206095710803543051403943216987041461657227865120060550884779774826635031628075397585946283610948419657197670564523306893061967398471068676639947658832265145695843719123156397743500589994432478416823231008575362765939928897626460248027885510001656393826256309367020970887009899289088082282630399775689118771093484673913970811537986235362428851698913560180761309087474697459067298213559515223153197054311990956008351391259365616205831652120464856452065559318971630373570344320032423556044479465039612720446996447306527763560955121488858122337173646802990032331936173738027603346898544120201609831376216094679507671771727017215461852519047279549422976800121578635268420323694737263447852058625699853806655715629575490226245358842201668101671755427395903976115493471925999331122860470178687881708940576489486324926642871714951647687007564248713962368460002634492848883456962495333367176401523748145796968997137722926387417354194355630559569194128538456098219367453361578555324662883932555800130300149150963975848830599711131219887479151721275399167507812610264345873287228147505042409733412193061973733678924428270640255302696506169682368258378164118273693242989466364290095136152263484073686875449928159250098536761969871746998629642122587312381230182031626033766629206649745453567218520262911130065786871423265792100546422721890736243047433379211152568090919222484875183286352724377349165707869875741561994764864879112051533698428749354250250746700561005676334541887374505649713489059328071656959918483759414320834945984936016480547184182544006980516066612823618484334696961622405727385839049333747811627716871957914798199285062836664480198641086164343479367748495549759561872145457891542118392410635200072925871630488447455995301678838058572433317486541345652396306268764829082955762544710793120544100706516132264905695450726094836847802179217630694739769666283814574691454345422621906028674856174796582924913888418010027628022315649288210917768240769537273232922745289657388055648683011507211694931949084841522133187598844638679222306328738188597234526279914402613668892571740204563464325098244685285778743640054534824477491189388617123364961803702693205028623829127521285688531128217449034980342989829451701846648589246256167537511635239390066149965628911437135146251124103346950085793679905236012023260331820678951559705911218030798127633625515280057841942050502307956258678226888174233356304541206070083243594778798958939107948158786056222584911928098110744943657558128946093376065670783092223480170036558071290396417438925997960169730003880377676134742097107141274897603382622868829107151129066210105320475526155051601403307805423373451613182045081443577675220795405659673437810238222972596876715453771644482906428423560786572225986386466798910831265732328581082613309536706281816303090981447786762983636680453351274383832325881595202415136061194126330745086591111855308963562717539174557872032738843245604541536917566329127085115965448484942788544066226499819403822471172831185700787593061660413358854523158239141326185588670256323464202872926329612112137155640018446864873963068821704870270272503588121088470748335097571146529169778902775434281380617872541140820964565606107417819351012541566973359902986182514762502462621613844435802417757314141116123781851252977322245800814985664393004761250675818417079977428695614416970123511056651923323971666131165615197963691747465019908554361637944593602230965516712987316269727214264513169033805643955388400246666487515957168430397022089759697081585403612877591590302964161622199832549254050905674525344749760024027859955523689663856770239115396237600367943363281042381560615905831475912559549104106040402800980896212886354192846329356591551555055188772525424589372827335086767430797828868205392913100595385088493928868690563965687705096693405859466079566124623960990468904143059333475472109374993218560558304042232513921753869118581725009654396103740689918919622756262014893285379192500450062085472402721122019990853704520053874283637570181308909480296109198302981239332087543074412206154531260926513469770094157377633134489119332134895072644022828725357379681471477942783656583166317482654133692870121414089091598040944224110419722180605570264411316101065104875983368194645028530971910472131885579326653247266667140764556195830576626842765494149783892990534204380595720065637169542809857006969771405264876910519067134594742156394561726922431317209848341736703403740054213742511328321320292789024080056113069007095327812290425734679239315335150931039685265367413018189896135670711511001637249630378031043154074997564757249958364137540538420415328067233658910880413082193675678134116221252776099391375994665543370142376379972971764068801010307045066390392896862085256679757349786964895562961092574131458324406595432998145466131584103032970403727587211708247584371039493012640121658959096546771622768752533812145660443747143098816862707043614550217664590053288918358888038908654070499051797740445880377196872963120052821778619211304290650830924220337106980996601717844426996971659539552542566584826629372839108758378085919755464203280369228597458554351266318927191206759999523733098733439462829837797477763707409050964619384289786236255882255410552761004288160386615558048798029646877008847528551988442935036363101639181848212870023991716232585990557952395212134102194499426135289224007516212528034430467708433465082792445643447663627064278216940233510198590034009037311196151839293168458357037405932970426642869860592813781118524627772992584025123274746541655542027105993518483110202977490290837630929837547847035911287146662420881793050528157049487855900503533775079613123065743738745146574941969661695020326725065252542750254263752931795304229711590123338732218674772444979780494176342049895117305057931978000546445601919700882303751666085576547477741610038426008471340002526416688558352216130529452116243631709263765345715743789995054263184190892477677465631354867176781327499311713036403611265740060272480098182045974726107194173548321260330072268161965728439035508287875189964676598035449204257640712657174925073415041024795192084472344159191820775798145482863458892866234163955036088584817200812901251130222135196772200571009680434847364958949195028562611573178484698404967031003311730184829631900194368816642971977833124888195647540569898216314028546844838512236835614623308169418968197460789918170733238649087269318909413014537661498420210120713246176321487925619872908211320473474836207096711538114181481071593665627473273496890921348975292228643533695235133168783639204931858108051217100194193808589174365066994674558928924778264681735301463939023324681676790675003070049135693972916240796481278117968673765387254357062465921710949578750354556176522588894075666315877864667383969534936095307989107866542225061237170870834628594957105839493985250421326170178607568810254621867715950627822071078389936149104617785546953299132100644428372230510997168305281602827609027745377457290128115521904797722235227699126115259252535811576687166199001779172387099162065313968486660105728550790840791656163793554133639737063816880183864228034251714536809027048970156878262844792898273755917790462274407028270032240321779566137524372563007706708831258944482763553861823329067793553575020492229446608019171492761164221534879749086394802968269473097464756038962434208641177988411314689196419790960799621708458032916468720618690902904011024289079115903795212631540891243647919366109601566023702863535422407392529138354133026414222446705108970242161498353443228426843030653729647831901646971919323068743330518910983127369957524759017472700240477466520141398927158725309721194501521413618855090674704704541261857445925737652886741743362194682601958400197916969729421802605557415099770745934922724700894562368099656554563399916232309"
        "3917091981987337683926144449849309045689590384324317220655411419536067249787242316192743375646924489742685762654217540058023830922386802680449656452642643872737602489370508189022948692584363089967460446640006459663654283135634676973116276772653314189030520223157860751329763846379492363522435030376718837369109029513908493350487587917689607387804140874729990121666131730030092499419378571637143546095282365653098334199939083036904274690868642103868054165370614089325709199752466330865469993424328586775066153331460045555670628028156233446499344568677894244871054504622990880631905005679457547221648616817529907698258708124302601384869544516117374272755349155744463528505655019542421626961082887911952200827378136232918887211315352949296471318265488544021128764874637211378287645940604804997429385989328433983685269229621969883124789854610329870758923312504834614335219873081959066447168996503080589924718185736110636234708241040819259088949623593847206972894770356049744713263076076330389958983979886952137890020042037702645485260900662916027025361405845005910914870924682692260606773857138563047526946853183984433336342612810332003086131061587495297407500615029631283154533986826944627054524962023286096674239903750000760809248360953948247849013915273476890263515165677014897209319925759407886027412138666283309417342322911107973767578302144712593184863422480168530874862071684132713653868794435985015770060381831619074539185516290948899881381228578071853143070199528782323307621630460490380389354473765731988838953866724430538978250145515707137332666681125618396138859826790736549588126672493637365889025233307769219516592910980421557127639460829831913981839223302528331589893381411658553459391995527155652964528531027985033261070315282448538786861170984462075153308744160364364504143737251393398766452582379931160572069489038524992226029161214658409043547319499057496500110052504629390308665742173031893776010913637183431744104516042030421372408276499566060173353390456771925321495755247566573432418276013509170208490113230664562064089311249241176011208548858491923081528706608747050954359878631963867215938697019384196165672084371036585003853092265031087883899180229660827574456163517339676955625427000711619049223530311471528735720866441160486179727893908280144248345029280715007084334222312368056324026655415210116764532233772123746509573174694019418149015784440646903372454361716752853725991946028442951429027515305276524811697200073271405180159590906147412757022436359972447207889805909378531532705928842273911356566316200020886396526389060546675632811590590062202108845691975137732159650996024872105714325556701110261376264385285417858630300576770195825529144548853133381225186882539671753259689222989744528484544961060802253597372543602562858586139980205788382841571269789045631628256360814400632709593024378244350239751677874945301452021511684129245541074394346348017005819240045736794186406548653655047181878506210122249330373800411731580853978471330343870098050120718685556697317497354173913492205919902680830336326578533930986809230611735629868115947124064840614968352530515707988179105899165390727317884568390430701811115378595491225088114016381911983332310866436135047595308339901186634846596445509551905500594084503751152330734882711329611027275075656276650760147694074621456564641422040086733473610662910322377072991516046725643356671635434331980462151069736008589278571617727853479197797400851521814321014926049517697732087391523710071471539496532007321165321589137767026492118999105306307943367521653780396849078886363297737049287238800484995485369594332809267353448584747236690391721505746740984960453131493661361394010867924701049617040414772139254305096400885900325389867419275142655435005620029110571275080714144603435745568915626657190889642503096718823173773094816381573065455195415373830301497591399674528266720122140434826232718098683093541856597260649678795606874103072640291195044499765230581103357644980449460291038980252460307581149649376181346808736353135196618591434390882577741795884381659253572042051544687597168434786697393766539538537897425613981915416306385636657832811390820684513935230706389052243540666781949466494992208967452831339939636750912155634977622219647569275899391848869642742227370492280823645219973095563806341124477462624696702043104218958374942896009057395329186232009294554932120827012925525455437178200567874188561537098316103756403711314034464960093144705149930818753520620009463665797454176108391119870880771817816015071656385828911170107294638270451561603099681454972697075550288702114060243770814120365091445587355451898097681482300757747530778251897538230332556393922884938791570078773342173490178176118442447932443396278405281812764261885975154951079407032270818160391867919914514847930646406873857622459495973444074545074269402353922209089430317559014914174638145529991354159143765333754730233295179144089072382273905532348285075744348805188246497034789308796800937509967765542315905717585103796163184741412969340167416386957941114906255744015407072022864935728021461522052197109450341526309110417367662164133233379085236981614341374173889787429659973524300058370840327894471536330686870427626459586863348664811081566750745206970105669433074414666954021943745476139834700812393339681832873003536377295763707491625734812015286541137709718223574978107723141179286450807506522534098138048224081788092506127034467389807626466667469852655963712914474420929368841882009698623368017953445378549898817525848377220916668608899777258318020172530749861752204954875951105577500684971923209453366806419176631849578284614685673476128492742246344271434050268582330191509654291382301721518288594078166396303084722703293588578953459240898565319590435980726358347600342707123949654321040905733680820781015405425586227807091434080585327226040650324495511444407830841384586362137389188960784051621622538934137113396142579265144103902712108436238478162293249045939990611112723269291729977267475563922912210428604685314529896270098142151937576374137328147441401997970407522657417953944807364407594748604361321816894544090670079397376452382015603493816411619551420709366192228166812636507448466413296171938314285167945679747018177651398997480279847925039452289986033324396180741414564511351132876890278231851416617736889254930838155526374808370519320345870883131035587267829531760633533607427218976199621217384636959422816814729067547090527066091899063862792590250206610260742633409490649915752462159968964966946148771085587309647759583237054596701645413216396228583450966876408886586847976157182940396398356701755419467102149489603442245634573187243103869596931032115692033648372808373067799139385134115794618014794273342630300208487732167359060812729100574941554496718903135470408577904067397042005717535132541601235253289338978693042209047558505184048560273247200524525954380031766331260309210402442687358012003133331853067900340383351423237251108708828162351168720425898042070969185531111489927544981331461169951497456970114302935647016958157291153633601743599092529916252403699817346200659172702187378926252719301651336078019315115262695198003652938335207026026689986757124610126889186820156032549632120747054550198638011172545303402734648795284859783781497086450648917445069382779217452114120351149468818484973222425284518800115631444330260317564302841456939579934696340193375839423700409519947843050301152360629240004925667482439236160250470068226518725483768957945368621731325585404460423493992318465624869023685656001313936223534136780229671521863580408795519193743254050912140028593860213909641113947222477339527708342881823288940747372852107768414817028163056407132402640266090100496723934042312697828590429982051621485570922009109160940167121417335633249544546322894871002985662285806688190565423095002700790964145028601466870080616876220555669090527079783919450450330196955611564105364215162266456481080502445772631536648728780176538669411556846494142230202517088143339935465120166250495962069159007171387424030932595873075561873173885287689942011768378729646802181738316530418947812140936824695116226720386362661226031266981574594024376558439451900514088068233599598965741366293433766491033656162595466719317002902029318310866589481126381075360194743943459295890045648274300065742202095593744585849076538944499539089991045189463493757393672125199202123320155411938334173265634292837709780221453416313763996090676668656838482617860646133418142957581230100700872765767836596056279562222274686161048565210300907380802636790493471401976098091869538384171829811705296944904430676536725764908630904856273520519580738288510223043271189389024622612287335320784689283280440364895730984377452703387756321256028470514422959568599413862302269961172242095875563792955294086001932385166000220309707396477793092643205454263709192441135846095304377136624947649547056497693864818713202462728976032034452318283189100527668039113709858863396673872212454034967113493705197754117034635062379286674882217821483991129840397654110807020893008798925745164283670110996897711375021620138102891175734772561163182381763738526902773160578788954366980519037451852624320453573197868603529588311291154820669460521954911363838414859460819927644195729312064563594826954631558402419984962664690166607844694643951225244904128288427405283958140676584665974420758480358764097101094638311071033976411421032633377978464970552276876149304390224397712908718115962498337854763537337041424595338110745716125546190401425692333739033185912083060909825683462853511256012049060828772354093845797080667047381791957224487466679569426640595729278383071827604273920781417585884965781195747464591953109557172562679554189084451808807742596248945450159190841861396597947174442815820241187174595619776799322568661322148817172915221568731129105138099106661326066381638029078570993677641994753262597497503311693339173636625549784681787125106095848766983079303882089591139755108505853330378843099699739483749208340555860472392887564146780941182320541145468277398237458270951283529333475884757417966043443045104601775213420363268870063648065519256018776753196156743625385229372170066533622184454019905913928435079196463126999208047061857482161640345432525389224293314933957917802545453386017545917695788233677443116800617650956227142084505740146615555708869516114764358621928247205531632875021020125103764651138873407018768679311090560897923593534670358096536084463418834586945384933874887796802930698681958364321425822286621743609458585785968656112354995850470917703695886826990972196013065838494388768518963154570550984676499254799793460316407337591997304570623096449781567592983051599191713720769495528457915926642280595080117954445815527377382221714966716669165488735799843644682184142359338802550913277911664535102354510286723822211250445464990169739506906115915356803532834048881501000744566430043546070993994692943013773187386132932104390711557542054064548604514284607351919016381843444416643313069397068919866491354773222345204925237038901436463023602315802803610314178811597428124914919119736479608883679515507723766201474754871260233775443055787173514411284548418981913420388863580479580241109378905187438628652098131624091316432267383078491590319805106727379401350407412803047142090169063512613920806511403849867745335846521901247512891844469861283787651413486868610995162457214052249970297637742408112548598068903711496107889918242325131837064751665085339319931917901488924292503273830763353534339856142200294887742549795752938994601219858670779258091875228170394132261912300860984341806456729122753771635520976181473694842081650957692854943781215297552623457352800576323192604333140870706269833809505947490735748040860353955999327118958469044522217534687536860079167780651827798049896709184672018358908777045182582194405133233174527002719574295221715218104447000355466264145715593294545416779132191945573906369484244081204288776313162428114773790361703495345143854243967624640487564155096086322751487294738034934866266255021011496237480246668746608926710661556131581296097672298361222015661386393432232552236224105055992897538809271471500070555433579491379187067399633702431869060169378317937961262640774376916737190458013613821418942186135410522363852200290152251963967320521909527032810323612105910807677385639306954696617228512904079232186396076941266611766571596351325789663164813429715040394618564607845020528366779753679634975395040730411888884673298388430449225041091945857122218880400366793244036739630143863200506054793716068417460254102118175221818854383360129416175486349570191497744873810496346861293270644646178688762192053873004379568597300011175331334275011644418381191256399490700770030535038867964031815667328160462185257096688618082756120515614171161499280696389203259875578493870985118628107700681615210145880020814443512284339917427442169965731890676356775874864753885803213593435183275879295866811801595440322201708211861669752345481569176631699642762911059568718139425419562702900169612407242892094746225981552738553763924442457346875914432194556421698266643837404766067270958122447322726983656811158919101817483532877661943041601312315917829041511177135532563394843365281005322481636627461794934231416637800205740048277012866543702522701804274555874968316255594014675566424490346799655856833220095158058554832992111244378861402855077010588833985337871332581054407784945839206561474056977774485775694714143476360636390623852050916197660653346387715602946763117077239494031809154234314105763721869408797529528503124768626487882804949886619527575243080750332878080388687705534958569905311850508499615280208584271790435172392921225264680429245300833521394139272095160035170431496844830578005242146936737400802624851975938567386299202833586392710714197789704323667477185180888822688354102163598285412644144218252378436717173820965231211332752419552141604556731263315414146069758127701751130758657557682142079615263636581650430343313639827743435026071643280244602491537692982178288286941339726651286586899310064828400125362684772585569700689552239188272151623961083592971360468839153493958836686129200556069280103448711541576229087641339940378738264531928355180393746593185129446182746464124194982240920651774664456797241789690474557550098983595945624994050329237271719615624944968045664222469681940699887464326589035274940713414736552410289088334372960661824427263878155000891868069057790038413259531856854975647508602930224963343655199131794024644527636976805944159218541329495966384566258420223938828450819530573415182798906126856851999916205669706719682516516720397674922642501493226682184182670123167826898821311457214579392855073202129825356706318552711924320079613759974614577981502088477155333689696992142088946890545474155279376740953084675314856836871716356093652532572661581792310488714086403778451479727173987065132092679054532210415557362702796089495731629862071579532687380181749306395480631029941936341067656361547034371537659534706071826293844728612343576578613571782511280751326424492442096852157100146299694731189163404163904959911721784238979159191979929678409809710223091429420804517671127182309976094771022763155349812580570538031428231310626819216341111395713911085937633440811719611236527194011296921369121780925248764968579432632208035576609039336824794816805403298939259168606072524363971252867471817430171458829296330880687039296490939494275020002810992391083334873994685669635698301816697210321119314781904791803484900655521684897880987727148336976005671716586701860139573074356390153249917230498427764829449639863866037364941250672701747782342847511157647873888049073543206262742809426947999614383741822894901650787155662884935742945713661071391798298798227592838081178839540452934807378001800047769349050445721775765774647426217417646144344425672141752606281987480282829367080778770221419176008101496858674352656993462914400134654815349284538953305408100802161100434227470355317124401685295927923163954094789535592105449486064687251677372480266065861113658918755210048450207344916339043799535770722187626979166146756682066045250623334940941167515156504752147658954801555141771222184602726077359791427567956634212593223580972437891201565811000822797129865808865275324554879231368131275584185609420152054332273588208485600178142355325718273687206284306667710783381779755922926468821894900037314911123316641837772024296573187375408481165850664330220289433841835966445965942162213596642691960607357255067445445501033908809215511666112694388740887871017173632824703768275986719074077976356516470233502200559195290952210853183267643716527511627104922315050867652572043812616250182059581702891037212814920102239333611227357651186276379150673920680082014814259315417463213534787905670646512698208669821624707421720138997946148398548725110228081355882372762921119023616947735756059368894437424445248004153469058785265735620772349231137532854406367470905183065659680825784644875933271868518921119275689676301589640270906655865675362884522280052739870680194871827368595567412473579929749996735937934241057634316159800859435873214689908355167611770051320718150876673150469295532928666224223546231342868131373734926466118683030256466387722238035263580189766795317849800586034531873077479117047785935093238621142764664288120472045981262250762754551400119546043691248558995220054311954776982626670013756583807212030750931494460469813228407223235875683132121612573482375907407842286306608806954725886973013042452380797730220521165782096488927915309029566497211174750117424926892016747201896372809215145133448018760388598890742338506490021468573272636889957172086409151885265365626972205604952212149840532483781169450314075232499386029233943989419187432561794218826496877109273254597963236258281854816886684389335757483177626694737079518943920781885348018560630442020759995248521709107828661970735906712465820255475170515495501433083773513336093850749065680831534336354389742124869398405602308913985033056854898644583312535332524326499137387203650107299993809500432559730753862605349934298300416");
#endif
}

BOOST_AUTO_TEST_CASE(Integer_Factorization_test) {
    Integer a = 1;
    for (auto i = 0; i <= boost::math::max_prime; ++i) {
        auto bp = boost::math::prime(i);
        auto& p = omnn::rt::prime(i);
        BOOST_TEST(bp == p);
    }

    auto maxPrimeIdx = 8;
    for (auto i = maxPrimeIdx; i-- > 0;) {
        a *= boost::math::prime(i);
    }

    std::cout << a << std::endl;

    std::cout << "Primes:\n";
    auto lastPrimeIdx = omnn::rt::primes();
    decltype(lastPrimeIdx) primeIdx = 0;
    auto prevPrime = omnn::rt::prime(lastPrimeIdx);
    decltype(prevPrime)
        newBound = unsigned(-1),
        nFact = 1,
        next = 3,
        prev = 1;
    for (auto i = 2; i < lastPrimeIdx; ++prev, ++i, ++next) {
        nFact *= i;
        auto fastPrimeTest = (prev * (nFact % next));
        if (fastPrimeTest != 0) {
            auto prime = fastPrimeTest / i + 2;
            std::cout << prime << ',';
            if (primeIdx < prevPrime)
                BOOST_TEST(omnn::rt::prime(primeIdx++) == prime);
        }
    }
    // test integer factors
    auto simpleMethodFactors = a.SimpleFactsSet();
    auto factors = a.FactSet(); // 256 items
    BOOST_TEST(simpleMethodFactors == factors);
    decltype(factors) notFound, recalculated, testSet{
        9699690, 4849845, 3233230, 1939938, 1616615, 1385670, 969969, 881790, 746130, 692835, 646646, 570570, 510510,
        461890,  440895,  373065,  323323,  293930,  285285,  277134, 255255, 248710, 230945, 190190, 176358, 170170,
        149226,  146965,  138567,  125970,  124355,  114114,  106590, 102102, 95095,  92378,  88179,  85085,  81510,
        74613,   72930,   67830,   62985,   58786,   57057,   53295,  51870,  51051,  49742,  46410,  46189,  43890,
        41990,   40755,   39270,   38038,   36465,   35530,   34034,  33915,  30030,  29393,  27170,  25935,  25194,
        24871,   24310,   23205,   22610,   21945,   21318,   20995,  19635,  19019,  17765,  17290,  17017,  16302,
        15470,   15015,   14630,   14586,   13585,   13566,   13090,  12597,  12155,  11305,  10659,  10374,  10010,
        9690,    9282,    8778,    8645,    8398,    8151,    7854,   7735,   7410,   7315,   7293,   7106,   6783,
        6630,    6545,    6270,    6006,    5610,    5434,    5187,   5005,   4862,   4845,   4641,   4522,   4389,
        4290,    4199,    3990,    3927,    3705,    3570,    3553,   3458,   3315,   3230,   3135,   3094,   3003,
        2926,    2805,    2730,    2717,    2618,    2470,    2431,   2310,   2261,   2210,   2145,   2090,   2002,
        1995,    1938,    1870,    1785,    1729,    1615,    1547,   1482,   1463,   1430,   1365,   1330,   1326,
        1309,    1254,    1235,    1190,    1155,    1122,    1105,   1045,   1001,   969,    935,    910,    858,
        798,     770,     741,     715,     714,     665,     663,    646,    627,    595,    570,    561,    546,
        510,     494,     462,     455,     442,     429,     418,    399,    390,    385,    374,    357,    330,
        323,     286,     285,     273,     266,     255,     247,    238,    231,    221,    210,    209,    195,
        190,     187,     182,     170,     165,     154,     143,    133,    130,    119,    114,    110,    105,
        102,     95,      91,      85,      78,      77,      70,     66,     65,     57,     55,     51,     42,
        39,      38,      35,      34,      33,      30,      26,     22,     21,     19,     17,     15,     14,
        13,      11,      10,      7,       6,       5,       3,      2,      1
    };
    auto up = a;
    for (Integer i = 1; i <= up; ++i) {
        auto d = a / i;
        if (d.IsInt()) {
            std::wcout << i << ", ";
            if (factors.find(i) == factors.end()) {
                notFound.insert(i);
            }
            recalculated.emplace(std::move(i));
            std::wcout << d << ", ";
            if (factors.find(d) == factors.end()) {
                notFound.insert(d);
            }
            up = d.as<Integer>();
            recalculated.emplace(std::move(d));
        }
    }
    BOOST_TEST(testSet == recalculated);
    if (testSet != factors) {
        std::cout << "\n\nmissing factor items: ";
        for (auto& f : notFound) {
            std::wcout << f << ' ';
        }
        std::cout << std::endl;
    }
    BOOST_TEST(testSet == factors);

    for (auto& f : factors) {
        std::wcout << f << ' ';
    }
    std::cout << std::endl;
}

BOOST_AUTO_TEST_CASE(Integer_sqrt_test)
{
    const int_t initial_a = 5;
    int_t a = initial_a, b = 18, z=0;
    for(;b-->z;)
    {
        auto sqroot=a;
        a *= a;

        auto timenow = chrono::system_clock::to_time_t(chrono::system_clock::now());
        cout << ctime(&timenow) << endl;
        int_t t;
        std::cout << measure<>::execution([&](){
            t = boost::multiprecision::sqrt(a.ca());
            auto match = t != sqroot.ca();

            if(match)
            {
                t = boost::multiprecision::sqrt(a.a());
            }
        }) << std::endl;
        BOOST_TEST(t==sqroot);
    }

    auto _ = 4_v;
    _ ^= 1_v/2;
    BOOST_TEST(_.Sq()==4_v);
    BOOST_TEST(_==2*((1)^(1_v/2)));
    auto _1 = _;
    _ *= _1;
    BOOST_TEST(_==4_v);
}
